# تطبيق إدارة الرخام والجرانيت

تطبيق أندرويد احترافي لإدارة شركات توريد وتركيب الرخام والجرانيت، مطور بلغة Python باستخدام Kivy/KivyMD.

## المميزات

- **إدارة المخزون**: تتبع المواد والكميات مع تنبيهات انخفاض المخزون
- **إدارة العملاء**: قاعدة بيانات شاملة للعملاء مع سجل الطلبات
- **إدارة العمال**: تسجيل الحضور وحساب الأجور (يومي/شهري/بالمتر المربع)
- **الفواتير**: إنشاء فواتير احترافية بصيغة PDF مع دعم RTL
- **التقارير**: تقارير مفصلة للمبيعات والأرباح والمخزون
- **المزامنة**: عمل بدون إنترنت مع إمكانية المزامنة الاختيارية
- **النسخ الاحتياطي**: تصدير واستيراد البيانات

## متطلبات التشغيل

- Python 3.11+
- Android 7.0+ (API 24+)

## التثبيت والتشغيل المحلي

### 1. تثبيت المتطلبات

```bash
pip install -r requirements.txt
```

### 2. تشغيل التطبيق

```bash
cd app
python main.py
```

## بناء APK

### APK Debug

```bash
./build_debug.sh
```

سيتم إنشاء الملف: `bin/marblegranitemanager-0.1-debug.apk`

### APK Release (موقع)

```bash
./build_release.sh
```

عند التشغيل لأول مرة، سيطلب منك إنشاء keystore جديد. اتبع التعليمات لإدخال المعلومات المطلوبة.

سيتم إنشاء الملف: `bin/marblegranitemanager-0.1-release.apk`

## هيكل المشروع

```
marble_granite_app/
├── app/                    # ملفات التطبيق الرئيسية
│   ├── main.py            # نقطة البداية
│   └── app.kv             # ملف التصميم
├── core/                  # الوحدات الأساسية
│   ├── models/            # نماذج قاعدة البيانات
│   ├── services/          # الخدمات (PDF، مزامنة، إشعارات)
│   ├── screens/           # شاشات التطبيق
│   ├── components/        # مكونات UI مشتركة
│   └── widgets/           # عناصر مخصصة
├── assets/                # الموارد (خطوط، صور، أيقونات)
├── tests/                 # اختبارات الوحدة
├── buildozer.spec         # إعدادات البناء
└── requirements.txt       # متطلبات Python
```

## المنطق المحاسبي

التطبيق يتبع منطق محاسبي دقيق:

- **المساحة** = الطول × العرض × عدد القطع (بالمتر المربع)
- **تكلفة الشراء** = المساحة × سعر الشراء/م²
- **سعر البيع** = المساحة × سعر البيع/م²
- **الإجمالي قبل الخصم** = سعر البيع + رسوم التوصيل + رسوم التركيب
- **الخصم** = نسبة الخصم × الإجمالي قبل الخصم
- **الأساس الخاضع للضريبة** = الإجمالي قبل الخصم - الخصم
- **الضريبة** = نسبة الضريبة × الأساس الخاضع للضريبة
- **الإجمالي النهائي** = الأساس الخاضع + الضريبة

## قاعدة البيانات

يستخدم التطبيق SQLite مع Peewee ORM للتخزين المحلي. جميع الجداول تحتوي على:
- `id`: المعرف الفريد
- `created_at`: تاريخ الإنشاء
- `updated_at`: تاريخ آخر تحديث
- `version`: رقم الإصدار للمزامنة
- `is_deleted`: حذف ناعم

## المزامنة

- **Offline-first**: جميع العمليات تعمل محلياً
- **مزامنة اختيارية**: عند توفر الإنترنت
- **حل التعارضات**: آخر كاتب يفوز (LWW)
- **أمان**: نقل مشفر عبر HTTPS

## الدعم الفني

للمساعدة أو الإبلاغ عن مشاكل، يرجى التواصل مع فريق التطوير.

## الترخيص

هذا المشروع مرخص تحت رخصة MIT.

